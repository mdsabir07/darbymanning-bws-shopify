 <section class="home-news" style="background-color: {{ section.settings.bg_color }};">
    <div class="o-grid  o-grid--small-pad">
      {% for block in section.blocks limit: section.settings.post_limit %}
      <div class="o-grid__item  u-size-6@s {% if forloop.first %}u-mB-20{% endif %}">
      {%- assign blog = blogs[block.settings.blog] -%}
      {% for article in blog.articles limit: 1 %}
          <article class="block border" aria-labelledby="FeaturedBlogTitle-{{ forloop.index0 }}-{{ section.id }}"> 
              <a href="{{ blog.url }}">
              	<p class="block__message block__message--white"><span>{{blog.title}} </span></p>
                {% if article.image %}
                <div class="home-news__img">
                  {%- assign img_url = article.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
                    <img
                        class="lazyload lazypreload"
                        src="{{ article.image | img_url: 'master' }}"
                        data-src="{{ img_url }}"
                        data-sizes="auto"
                        alt="{{ block.settings.image.alt | escape }}">
                </div>
                {% endif %}
              </a>
              <div class="block__info  block__info--white">
                  <h3 class="block__title block__title--mid" id="FeaturedBlogTitle-{{ forloop.index0 }}-{{ section.id }}">
                    {{ article.title }}
                  </h3>
                  <div class="block__p">
                    {% if article.excerpt.size > 0 %}
                      {{ article.excerpt }}
                    {% else %}
                     {{ article.content | strip_html | truncate: 150 }}
                    {% endif %}
                  </div>

                  {% if block.settings.button_label != blank and block.settings.button_link != blank %}
                  <div class="block__buttons u-pT-32 ">
                    <a href="{{ block.settings.button_link }}"
                      class="btn button"
                      aria-label="{{ 'blogs.article.read_more_title' | t: title: article.title }}">
                      {{- block.settings.button_label | escape -}}
                    </a>
                  </div>
                {% endif %}
              </div>
          </article>
          {% endfor %}
        </div>
      {% endfor %}
    </div>
</section>

{% schema %}
{
  "name": "Featured Blog Posts",
  "class": "index-section",
  "settings": [],
  "blocks": [
    {
      "type": "blog_category",
      "name": "Blog Category",
      "settings": [
          {
          "id": "blog",
          "type": "blog",
          "label": "Blog"
      },
      {
        "type": "text",
        "id": "button_label",
        "label": "Button label"
      },
      {
        "type": "url",
        "id": "button_link",
        "label": "Button link"
      }
     ]
    }
  ],
  "presets": [
    {
      "name": "Blog posts",
      "category": "Blog",
        "blocks": [
        {
          "type": "blog_category"
        },
        {
          "type": "blog_category"
        }
      ]
    }
  ]
}
{% endschema %}

